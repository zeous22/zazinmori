{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1XMynpglg4JEqsriiYf0CWT-dSRBCjC3u","timestamp":1663517195777}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"TPU","gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"fd474c46b22c4925b246fd815513736d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_95c05bffdd694c999a8c3e3d20ac4de5","IPY_MODEL_62c1b8988f444c80b6d45fe6132c115a","IPY_MODEL_fc7a98d57e3e4bedb523cd96c7ab50e9"],"layout":"IPY_MODEL_bf133117c4c64092b78743f91fe49114"}},"95c05bffdd694c999a8c3e3d20ac4de5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_915a7543d82a4fc08b3dd23aad0d59c3","placeholder":"​","style":"IPY_MODEL_5b2e28ded3704f1f92fa3a51af30c986","value":"Downloading: 100%"}},"62c1b8988f444c80b6d45fe6132c115a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_5736ede1bc244797a4ec6464ada9be04","max":252,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3ff348dcbe234c4daf07806d92408fe7","value":252}},"fc7a98d57e3e4bedb523cd96c7ab50e9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9ef90793d14743c39cc7266856cb11dc","placeholder":"​","style":"IPY_MODEL_c54809643fbc480691a38299059e7b5b","value":" 252/252 [00:00&lt;00:00, 2.12kB/s]"}},"bf133117c4c64092b78743f91fe49114":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"915a7543d82a4fc08b3dd23aad0d59c3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5b2e28ded3704f1f92fa3a51af30c986":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"5736ede1bc244797a4ec6464ada9be04":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3ff348dcbe234c4daf07806d92408fe7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9ef90793d14743c39cc7266856cb11dc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c54809643fbc480691a38299059e7b5b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"928332aec5ff4533b428a4a0a82cb9e7":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3486435d46fd427e8d03eba2a0bcc13d","IPY_MODEL_49c00a3651124d99a84b4d46396dda81","IPY_MODEL_67ef79e5e33d49f188c133a61dd9719f"],"layout":"IPY_MODEL_674c0afdebf94041a78917b371a451bc"}},"3486435d46fd427e8d03eba2a0bcc13d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_14e61c1ed4934000a6f6071ab305cb07","placeholder":"​","style":"IPY_MODEL_82d454f1e21a4e868d129477efc24628","value":"Downloading: 100%"}},"49c00a3651124d99a84b4d46396dda81":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4b422049b9e4434b975c62190cc03e6d","max":2514827,"min":0,"orientation":"horizontal","style":"IPY_MODEL_27ccdc68a0b24cbdbe993564e9d472a8","value":2514827}},"67ef79e5e33d49f188c133a61dd9719f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_dc27334a641343d89e3b9e24e0ce0bd4","placeholder":"​","style":"IPY_MODEL_f7c34f7121cf426dbeb98a5e8d10d165","value":" 2.51M/2.51M [00:00&lt;00:00, 9.21MB/s]"}},"674c0afdebf94041a78917b371a451bc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"14e61c1ed4934000a6f6071ab305cb07":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"82d454f1e21a4e868d129477efc24628":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4b422049b9e4434b975c62190cc03e6d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"27ccdc68a0b24cbdbe993564e9d472a8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"dc27334a641343d89e3b9e24e0ce0bd4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f7c34f7121cf426dbeb98a5e8d10d165":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6c81504a9aa24803a3b7b48a561bab6a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_67000fe56986413f8638b67ed5ba70b1","IPY_MODEL_de9c25c5dcdf48ef8f6265b883f204da","IPY_MODEL_f7d3306e757e40d0983c2e196be4330f"],"layout":"IPY_MODEL_ff04ec0fb6364eeb9bcb16574d7ebc03"}},"67000fe56986413f8638b67ed5ba70b1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_be1cbfe59e5c482f8e762436808bfc10","placeholder":"​","style":"IPY_MODEL_a8aef3704f0747f69b1c6f6cf0533f7b","value":"Downloading: 100%"}},"de9c25c5dcdf48ef8f6265b883f204da":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0b9d90e9083844e0830bc2def7acd322","max":88,"min":0,"orientation":"horizontal","style":"IPY_MODEL_3fcd113a35f549b0a2b17fa13e85d42f","value":88}},"f7d3306e757e40d0983c2e196be4330f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_483e83f43082456fa4a00f2c58777750","placeholder":"​","style":"IPY_MODEL_961878f5654b4f78917455e257577766","value":" 88.0/88.0 [00:00&lt;00:00, 661B/s]"}},"ff04ec0fb6364eeb9bcb16574d7ebc03":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"be1cbfe59e5c482f8e762436808bfc10":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a8aef3704f0747f69b1c6f6cf0533f7b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0b9d90e9083844e0830bc2def7acd322":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3fcd113a35f549b0a2b17fa13e85d42f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"483e83f43082456fa4a00f2c58777750":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"961878f5654b4f78917455e257577766":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0d5033c0f75145ecadf9643fca3fabc2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_03e7b37973374fe58eeea2ed8b3ebd1a","IPY_MODEL_dcfa2437a083474babd641b9501d9696","IPY_MODEL_98f413b19ed4490b9a8a4bc01081e25e"],"layout":"IPY_MODEL_d572ead914bc4f6ebdad7bf2e132e6b8"}},"03e7b37973374fe58eeea2ed8b3ebd1a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cc79b8720ee24225a4fb28865c6aa4f2","placeholder":"​","style":"IPY_MODEL_4a46f952c2c14d9fba9104c7958c0e2c","value":"Downloading: 100%"}},"dcfa2437a083474babd641b9501d9696":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0ed2b703a3fe4016aeee91197858cfef","max":1000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8e6bc5dccb6943df9cc5419605b19ebd","value":1000}},"98f413b19ed4490b9a8a4bc01081e25e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_16578ed5bb0b49c589299e4eac32331a","placeholder":"​","style":"IPY_MODEL_fe6e438a8c254d2e86eb53096c4b1856","value":" 1.00k/1.00k [00:00&lt;00:00, 5.61kB/s]"}},"d572ead914bc4f6ebdad7bf2e132e6b8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cc79b8720ee24225a4fb28865c6aa4f2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4a46f952c2c14d9fba9104c7958c0e2c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0ed2b703a3fe4016aeee91197858cfef":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8e6bc5dccb6943df9cc5419605b19ebd":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"16578ed5bb0b49c589299e4eac32331a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fe6e438a8c254d2e86eb53096c4b1856":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3ce8f62eca194a03bdb0eecbb3092ed6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ebf2d7a3515243eba9588469282eb927","IPY_MODEL_b46d58e32a8146378dbdc7de5c539e3b","IPY_MODEL_b8a40fa51769497c8c7bf5562a967c06"],"layout":"IPY_MODEL_9d418faef1a64ba1b445dcb9e43023d5"}},"ebf2d7a3515243eba9588469282eb927":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_689bd0d4140444729bf5364912d89966","placeholder":"​","style":"IPY_MODEL_099f76983af64133a8a8d99940e0907f","value":"Downloading: 100%"}},"b46d58e32a8146378dbdc7de5c539e3b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_2f5fd737b69347feb13c107a4b549a67","max":513302779,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f08f685d7cc2430389e23ce32f46219c","value":513302779}},"b8a40fa51769497c8c7bf5562a967c06":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_525845a1894a45bd8eb24f964c83f1bb","placeholder":"​","style":"IPY_MODEL_566d4be5380c482388f208eead478373","value":" 513M/513M [00:37&lt;00:00, 39.6MB/s]"}},"9d418faef1a64ba1b445dcb9e43023d5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"689bd0d4140444729bf5364912d89966":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"099f76983af64133a8a8d99940e0907f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2f5fd737b69347feb13c107a4b549a67":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f08f685d7cc2430389e23ce32f46219c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"525845a1894a45bd8eb24f964c83f1bb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"566d4be5380c482388f208eead478373":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["!pip install transformers\n","!pip install accelerate"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vSe9tE5kNlvy","executionInfo":{"status":"ok","timestamp":1664420313844,"user_tz":-540,"elapsed":30409,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"5c1d4f34-ca38-46c1-c6c3-a482bb495dd8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.22.2-py3-none-any.whl (4.9 MB)\n","\u001b[K     |████████████████████████████████| 4.9 MB 5.3 MB/s \n","\u001b[?25hRequirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2022.6.2)\n","Collecting tokenizers!=0.11.3,<0.13,>=0.11.1\n","  Downloading tokenizers-0.12.1-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (6.6 MB)\n","\u001b[K     |████████████████████████████████| 6.6 MB 38.7 MB/s \n","\u001b[?25hCollecting huggingface-hub<1.0,>=0.9.0\n","  Downloading huggingface_hub-0.10.0-py3-none-any.whl (163 kB)\n","\u001b[K     |████████████████████████████████| 163 kB 45.6 MB/s \n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.64.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.8.0)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.12.0)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.7/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.9.0->transformers) (4.1.1)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.9)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.8.1)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2022.6.15)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Installing collected packages: tokenizers, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.10.0 tokenizers-0.12.1 transformers-4.22.2\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting accelerate\n","  Downloading accelerate-0.12.0-py3-none-any.whl (143 kB)\n","\u001b[K     |████████████████████████████████| 143 kB 4.7 MB/s \n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from accelerate) (1.21.6)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from accelerate) (21.3)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.7/dist-packages (from accelerate) (5.4.8)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from accelerate) (6.0)\n","Requirement already satisfied: torch>=1.4.0 in /usr/local/lib/python3.7/dist-packages (from accelerate) (1.12.1+cu113)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->accelerate) (3.0.9)\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch>=1.4.0->accelerate) (4.1.1)\n","Installing collected packages: accelerate\n","Successfully installed accelerate-0.12.0\n"]}]},{"cell_type":"markdown","source":["런타임 유형변경 TPU "],"metadata":{"id":"8g0Xl7hDbtYu"}},{"cell_type":"code","source":["import tensorflow as tf\n","import os\n","\n","resolver = tf.distribute.cluster_resolver.TPUClusterResolver(tpu='grpc://' + os.environ['COLAB_TPU_ADDR'])\n","\n","tf.config.experimental_connect_to_cluster(resolver)\n","tf.tpu.experimental.initialize_tpu_system(resolver)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"F7p8sqIVVWq2","executionInfo":{"status":"ok","timestamp":1664420326781,"user_tz":-540,"elapsed":12942,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"0fd39bf6-a0c7-4ec1-aff5-ba6df02c21bf"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<tensorflow.python.tpu.topology.Topology at 0x7f4d264f6310>"]},"metadata":{},"execution_count":2}]},{"cell_type":"code","source":["strategy = tf.distribute.experimental.TPUStrategy(resolver)"],"metadata":{"id":"sukzdtZoVesq","executionInfo":{"status":"ok","timestamp":1664420326782,"user_tz":-540,"elapsed":14,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"39f28213-d3df-499b-e8d0-979e9daf8d8b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:absl:`tf.distribute.experimental.TPUStrategy` is deprecated, please use  the non experimental symbol `tf.distribute.TPUStrategy` instead.\n"]}]},{"cell_type":"code","source":["# from google.colab import drive\n","# drive.mount('/content/drive')"],"metadata":{"id":"R0mIztcxrUlZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import transformers\n","transformers.__version__"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"ZMlAs-HuSBZf","executionInfo":{"status":"ok","timestamp":1664420327546,"user_tz":-540,"elapsed":772,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"e6956b8f-5f82-4f97-8fd1-f12326483bd6"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'4.22.2'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":["import pandas as pd\n","import numpy as np\n","import urllib.request\n","import os\n","from tqdm import tqdm\n","import tensorflow as tf\n","from transformers import AutoTokenizer, TFGPT2Model\n","from tensorflow.keras.preprocessing.sequence import pad_sequences"],"metadata":{"id":"QXSMTK3WSCxX"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# urllib.request.urlretrieve(\"https://raw.githubusercontent.com/e9t/nsmc/master/ratings_train.txt\", filename=\"ratings_train.txt\")\n","# urllib.request.urlretrieve(\"https://raw.githubusercontent.com/e9t/nsmc/master/ratings_test.txt\", filename=\"ratings_test.txt\")\n","# train_data = pd.read_csv('/content/drive/MyDrive/4조_Study/KoGPT/data/train_data.csv')\n","# test_data = pd.read_csv('/content/drive/MyDrive/4조_Study/KoGPT/data/test_data.csv')"],"metadata":{"id":"RUBcJ8uKSHVt"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# 구글드라이브 csv 공유파일 불러오기\n","import pandas as pd\n","url=\"https://drive.google.com/file/d/1YlUzrLgTJ8I58zX__n6bwSjuyubzov4J/view?usp=sharing\" #구글드라이브 csv파일 이미지 주소\n","path='https://drive.google.com/uc?id='+url.split('/')[-2]\n","print(\"▶ 공유파일 링크변환 경로명 : \", path)\n","train_data=pd.read_csv(path)\n","train_data.head()\n","url2=\"https://drive.google.com/file/d/1mE45bAji6ByFfTHnckQJxObs3PGAHh-2/view?usp=sharing\" #구글드라이브 csv파일 이미지 주소\n","path2='https://drive.google.com/uc?id='+url2.split('/')[-2]\n","print(\"▶ 공유파일 링크변환 경로명 : \", path2)\n","test_data=pd.read_csv(path2)\n","test_data.head()"],"metadata":{"id":"HgsYsw9ISKlP","colab":{"base_uri":"https://localhost:8080/","height":243},"executionInfo":{"status":"ok","timestamp":1664420333415,"user_tz":-540,"elapsed":2606,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"7ab2271c-1380-4104-84ac-aed9d8228965"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["▶ 공유파일 링크변환 경로명 :  https://drive.google.com/uc?id=1YlUzrLgTJ8I58zX__n6bwSjuyubzov4J\n","▶ 공유파일 링크변환 경로명 :  https://drive.google.com/uc?id=1mE45bAji6ByFfTHnckQJxObs3PGAHh-2\n"]},{"output_type":"execute_result","data":{"text/plain":["       corp_nm                                           document  label\n","0    (사) 금융결제원  작년에 인터넷에서 금융결제원에서 제공하는 계좌통합조회 서비스에 대해 알게 되었고 바...      1\n","1    (사) 금융결제원  금융결제원은 금융 전산 공동망, 지급결제시스템, 공인인증 등 금융 분야의 핵심 인프...      0\n","2    (사)한국무역협회  <[약점에 가려진 강점을 발견하는 것]\\n\\n2018년 2학기 중국정치 과목을 수강...      1\n","3  (재)경기도일자리재단  [일반 행정 경력]\\n\\n의료용 제품을 생산, 수출하는 중소기업에서 일반 행정 업무...      1\n","4  (재)경기도일자리재단  [일자리를 잡아바!]\\n\\n대학 졸업 후 취업을 준비하면서 일자리가 부족한 현실을 ...      0"],"text/html":["\n","  <div id=\"df-10e1ab87-535f-4469-9f67-e259ca4af4e6\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>corp_nm</th>\n","      <th>document</th>\n","      <th>label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>(사) 금융결제원</td>\n","      <td>작년에 인터넷에서 금융결제원에서 제공하는 계좌통합조회 서비스에 대해 알게 되었고 바...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>(사) 금융결제원</td>\n","      <td>금융결제원은 금융 전산 공동망, 지급결제시스템, 공인인증 등 금융 분야의 핵심 인프...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>(사)한국무역협회</td>\n","      <td>&lt;[약점에 가려진 강점을 발견하는 것]\\n\\n2018년 2학기 중국정치 과목을 수강...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>(재)경기도일자리재단</td>\n","      <td>[일반 행정 경력]\\n\\n의료용 제품을 생산, 수출하는 중소기업에서 일반 행정 업무...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>(재)경기도일자리재단</td>\n","      <td>[일자리를 잡아바!]\\n\\n대학 졸업 후 취업을 준비하면서 일자리가 부족한 현실을 ...</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-10e1ab87-535f-4469-9f67-e259ca4af4e6')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-10e1ab87-535f-4469-9f67-e259ca4af4e6 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-10e1ab87-535f-4469-9f67-e259ca4af4e6');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["print('훈련용 자소서 개수 :',len(train_data)) # 훈련용 리뷰 개수 출력"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4L4V6DG2SL8W","executionInfo":{"status":"ok","timestamp":1664420333416,"user_tz":-540,"elapsed":7,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"9a0c9b31-1e46-4cea-faf0-47fe97fa5f67"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["훈련용 자소서 개수 : 5363\n"]}]},{"cell_type":"code","source":["from collections import Counter"],"metadata":{"id":"OW9GEBqmLeSg"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# 0 지원동기 / 1 경험관련\n","Counter(train_data['label']).most_common()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"amPuV4C_LQsj","executionInfo":{"status":"ok","timestamp":1664420333782,"user_tz":-540,"elapsed":23,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"e605527b-b4dd-414f-c8e4-ecf128215971"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[(0, 3001), (1, 2362)]"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","source":["print('테스트용 자소서 개수 :',len(test_data)) # 테스트용 리뷰 개수 출력"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dExcHo_JSM9G","executionInfo":{"status":"ok","timestamp":1664420333783,"user_tz":-540,"elapsed":23,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"40505a7e-a388-4bc9-c17c-a597010a048c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["테스트용 자소서 개수 : 518\n"]}]},{"cell_type":"code","source":["Counter(test_data['label']).most_common()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"u9nDhtOeMHQo","executionInfo":{"status":"ok","timestamp":1664420333784,"user_tz":-540,"elapsed":22,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"327544dc-90b1-4e12-9428-377bdad06fb0"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[(0, 265), (1, 253)]"]},"metadata":{},"execution_count":13}]},{"cell_type":"code","source":["train_data[:5] # 상위 5개 출력"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"QNVLD0ruSOBW","executionInfo":{"status":"ok","timestamp":1664420333785,"user_tz":-540,"elapsed":21,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"69e239c3-714d-4e2e-8e1d-ca2e78b5470a"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["        corp_nm                                           document  label\n","0   (사)대한산업안전협회  저의 특별한 경험은 달성하기 힘들어 보였던 목표에 끊임없이 노력하고 도전하여 성취를...      1\n","1      (사)대한체육회  대한체육회의 주요 사업에는 스포츠 활성화 기반조성, 스포츠 참여의 확대가 있습니다....      0\n","2  (사)한국정보산업연합회  [자기 자신에게 불을 지펴라]\\n\\n대학원 2학기가 되서 처음으로 프로젝트를 담당하...      1\n","3  (사)한국지방재정공제회  [수많은 연습을 통해 갈고 닦은 직무 역량]\\n한국지방재정공제회 처음 접하게 된 것...      0\n","4         (유)삼송  \"헌신과 책임감을 지닌 인재\"\\n\\n군대를 전역한 후 하락한 끈기와 의지를 끌어올리...      1"],"text/html":["\n","  <div id=\"df-4036c3cb-859d-44b4-9d73-ef5258971198\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>corp_nm</th>\n","      <th>document</th>\n","      <th>label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>(사)대한산업안전협회</td>\n","      <td>저의 특별한 경험은 달성하기 힘들어 보였던 목표에 끊임없이 노력하고 도전하여 성취를...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>(사)대한체육회</td>\n","      <td>대한체육회의 주요 사업에는 스포츠 활성화 기반조성, 스포츠 참여의 확대가 있습니다....</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>(사)한국정보산업연합회</td>\n","      <td>[자기 자신에게 불을 지펴라]\\n\\n대학원 2학기가 되서 처음으로 프로젝트를 담당하...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>(사)한국지방재정공제회</td>\n","      <td>[수많은 연습을 통해 갈고 닦은 직무 역량]\\n한국지방재정공제회 처음 접하게 된 것...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>(유)삼송</td>\n","      <td>\"헌신과 책임감을 지닌 인재\"\\n\\n군대를 전역한 후 하락한 끈기와 의지를 끌어올리...</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-4036c3cb-859d-44b4-9d73-ef5258971198')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-4036c3cb-859d-44b4-9d73-ef5258971198 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-4036c3cb-859d-44b4-9d73-ef5258971198');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":14}]},{"cell_type":"code","source":["test_data[:5] # 상위 5개 출력"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"DEU4pEMaSO4-","executionInfo":{"status":"ok","timestamp":1664420333786,"user_tz":-540,"elapsed":22,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"3b34791c-353f-40b4-8edc-cc6b48fa2ec7"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["       corp_nm                                           document  label\n","0    (사) 금융결제원  작년에 인터넷에서 금융결제원에서 제공하는 계좌통합조회 서비스에 대해 알게 되었고 바...      1\n","1    (사) 금융결제원  금융결제원은 금융 전산 공동망, 지급결제시스템, 공인인증 등 금융 분야의 핵심 인프...      0\n","2    (사)한국무역협회  <[약점에 가려진 강점을 발견하는 것]\\n\\n2018년 2학기 중국정치 과목을 수강...      1\n","3  (재)경기도일자리재단  [일반 행정 경력]\\n\\n의료용 제품을 생산, 수출하는 중소기업에서 일반 행정 업무...      1\n","4  (재)경기도일자리재단  [일자리를 잡아바!]\\n\\n대학 졸업 후 취업을 준비하면서 일자리가 부족한 현실을 ...      0"],"text/html":["\n","  <div id=\"df-731f7b60-81b0-48ba-9333-c6642bd0c1c5\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>corp_nm</th>\n","      <th>document</th>\n","      <th>label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>(사) 금융결제원</td>\n","      <td>작년에 인터넷에서 금융결제원에서 제공하는 계좌통합조회 서비스에 대해 알게 되었고 바...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>(사) 금융결제원</td>\n","      <td>금융결제원은 금융 전산 공동망, 지급결제시스템, 공인인증 등 금융 분야의 핵심 인프...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>(사)한국무역협회</td>\n","      <td>&lt;[약점에 가려진 강점을 발견하는 것]\\n\\n2018년 2학기 중국정치 과목을 수강...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>(재)경기도일자리재단</td>\n","      <td>[일반 행정 경력]\\n\\n의료용 제품을 생산, 수출하는 중소기업에서 일반 행정 업무...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>(재)경기도일자리재단</td>\n","      <td>[일자리를 잡아바!]\\n\\n대학 졸업 후 취업을 준비하면서 일자리가 부족한 현실을 ...</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-731f7b60-81b0-48ba-9333-c6642bd0c1c5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-731f7b60-81b0-48ba-9333-c6642bd0c1c5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-731f7b60-81b0-48ba-9333-c6642bd0c1c5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":15}]},{"cell_type":"code","source":["train_data = train_data.dropna(how = 'any') # Null 값이 존재하는 행 제거\n","train_data = train_data.reset_index(drop=True)\n","print(train_data.isnull().values.any()) # Null 값이 존재하는지 확인"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"h1UDqX_ySPsG","executionInfo":{"status":"ok","timestamp":1664420333787,"user_tz":-540,"elapsed":22,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"0fac6e00-7b3a-4d23-f4dd-c9a3ff46e75a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["False\n"]}]},{"cell_type":"code","source":["test_data = test_data.dropna(how = 'any') # Null 값이 존재하는 행 제거\n","test_data = test_data.reset_index(drop=True)\n","print(test_data.isnull().values.any()) # Null 값이 존재하는지 확인"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"PTl0PaQRSQz2","executionInfo":{"status":"ok","timestamp":1664420333787,"user_tz":-540,"elapsed":19,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"c3fb445e-f875-4bfc-8e41-b83ae35ae6b0"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["False\n"]}]},{"cell_type":"code","source":["print(len(train_data))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ny_xUm5SSRuf","executionInfo":{"status":"ok","timestamp":1664420334197,"user_tz":-540,"elapsed":427,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"d00ca938-c0b1-40e3-f3ab-703430009eab"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["5363\n"]}]},{"cell_type":"code","source":["print(len(test_data))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bKaWAdYNSTJe","executionInfo":{"status":"ok","timestamp":1664420334198,"user_tz":-540,"elapsed":14,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"6c96f32d-7a1e-4d43-b379-64ecf31a70ff"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["518\n"]}]},{"cell_type":"code","source":["# KoGPT-3 \n","import torch\n","from transformers import AutoTokenizer, AutoModelForCausalLM \n","\n","tokenizer = AutoTokenizer.from_pretrained(\n","  'kakaobrain/kogpt', revision='KoGPT6B-ryan1.5b-float16',  # or float32 version: revision=KoGPT6B-ryan1.5b\n","  bos_token='[BOS]', eos_token='[EOS]', unk_token='[UNK]', pad_token='[PAD]', mask_token='[MASK]'\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":113,"referenced_widgets":["fd474c46b22c4925b246fd815513736d","95c05bffdd694c999a8c3e3d20ac4de5","62c1b8988f444c80b6d45fe6132c115a","fc7a98d57e3e4bedb523cd96c7ab50e9","bf133117c4c64092b78743f91fe49114","915a7543d82a4fc08b3dd23aad0d59c3","5b2e28ded3704f1f92fa3a51af30c986","5736ede1bc244797a4ec6464ada9be04","3ff348dcbe234c4daf07806d92408fe7","9ef90793d14743c39cc7266856cb11dc","c54809643fbc480691a38299059e7b5b","928332aec5ff4533b428a4a0a82cb9e7","3486435d46fd427e8d03eba2a0bcc13d","49c00a3651124d99a84b4d46396dda81","67ef79e5e33d49f188c133a61dd9719f","674c0afdebf94041a78917b371a451bc","14e61c1ed4934000a6f6071ab305cb07","82d454f1e21a4e868d129477efc24628","4b422049b9e4434b975c62190cc03e6d","27ccdc68a0b24cbdbe993564e9d472a8","dc27334a641343d89e3b9e24e0ce0bd4","f7c34f7121cf426dbeb98a5e8d10d165","6c81504a9aa24803a3b7b48a561bab6a","67000fe56986413f8638b67ed5ba70b1","de9c25c5dcdf48ef8f6265b883f204da","f7d3306e757e40d0983c2e196be4330f","ff04ec0fb6364eeb9bcb16574d7ebc03","be1cbfe59e5c482f8e762436808bfc10","a8aef3704f0747f69b1c6f6cf0533f7b","0b9d90e9083844e0830bc2def7acd322","3fcd113a35f549b0a2b17fa13e85d42f","483e83f43082456fa4a00f2c58777750","961878f5654b4f78917455e257577766"]},"id":"BMxpl8sqcH8s","executionInfo":{"status":"ok","timestamp":1664420336593,"user_tz":-540,"elapsed":2405,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"bf61302f-30ab-4a64-9f31-ce832022cd3b"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/252 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"fd474c46b22c4925b246fd815513736d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/2.51M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"928332aec5ff4533b428a4a0a82cb9e7"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/88.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6c81504a9aa24803a3b7b48a561bab6a"}},"metadata":{}}]},{"cell_type":"code","source":["# # KoGPT-2\n","# tokenizer = AutoTokenizer.from_pretrained('skt/kogpt2-base-v2', bos_token='</s>', eos_token='</s>', pad_token='<pad>')"],"metadata":{"id":"UJyx_Nk1SUYf"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(tokenizer.encode(\"작년에 인터넷에서 금융결제원에서 제공하는 계좌통합조회 서비스에 대해 알게 되었고 \"))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"OWXdqpicSWIX","executionInfo":{"status":"ok","timestamp":1664420336595,"user_tz":-540,"elapsed":14,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"7bf2b974-7b48-4fb1-a45e-aa1d369ac52d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[17334, 379, 3116, 463, 2714, 16085, 505, 463, 1713, 385, 378, 12513, 6883, 25743, 1902, 379, 1294, 821, 478, 693, 529, 395, 327]\n"]}]},{"cell_type":"code","source":["print(tokenizer.tokenize(\"작년에 인터넷에서 금융결제원에서 제공하는 계좌통합조회 서비스에 대해 알게 되었고\"))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"IGO-FkfASa0H","executionInfo":{"status":"ok","timestamp":1664420336595,"user_tz":-540,"elapsed":13,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"e21fdf78-5c3e-468f-d490-08dd4906bf10"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['ìŀĳëħĦ', 'ìĹĲ', 'ĠìĿ¸íĦ°ëĦ·', 'ìĹĲìĦľ', 'Ġê¸Īìľµ', 'ê²°ìłľ', 'ìĽĲ', 'ìĹĲìĦľ', 'Ġìłľê³µ', 'íķĺ', 'ëĬĶ', 'Ġê³Ħì¢Į', 'íĨµíķ©', 'ì¡°íļĮ', 'ĠìĦľë¹ĦìĬ¤', 'ìĹĲ', 'ĠëĮĢíķ´', 'ĠìķĮ', 'ê²Į', 'ĠëĲĺ', 'ìĹĪ', 'ê³ł']\n"]}]},{"cell_type":"code","source":["tokenizer.decode(tokenizer.encode(\"작년에 인터넷에서 금융결제원에서 제공하는 계좌통합조회 서비스에 대해 알게 되었고\"))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"BgfLVSygSd2w","executionInfo":{"status":"ok","timestamp":1664420336596,"user_tz":-540,"elapsed":10,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"595460a7-22e6-4ca9-9f4c-97999a27668f"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'작년에 인터넷에서 금융결제원에서 제공하는 계좌통합조회 서비스에 대해 알게 되었고'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":24}]},{"cell_type":"code","source":["for elem in tokenizer.encode(\"작년에 인터넷에서 금융결제원에서 제공하는 계좌통합조회 서비스에 대해 알게 되었고\"):\n","  print(tokenizer.decode(elem))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"jH5Rg1mPShbf","executionInfo":{"status":"ok","timestamp":1664420336596,"user_tz":-540,"elapsed":9,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"c584dd89-afda-4014-af06-d9a9408d093a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["작년\n","에\n"," 인터넷\n","에서\n"," 금융\n","결제\n","원\n","에서\n"," 제공\n","하\n","는\n"," 계좌\n","통합\n","조회\n"," 서비스\n","에\n"," 대해\n"," 알\n","게\n"," 되\n","었\n","고\n"]}]},{"cell_type":"code","source":["print(tokenizer.tokenize(\"헌신과 책임감을 지닌 인재 군대를 전역한 후 하락한 끈기와 의지를 끌어올리\"))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Z3FKObF2Sj8P","executionInfo":{"status":"ok","timestamp":1664420336928,"user_tz":-540,"elapsed":339,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"5a5efc91-1cf7-42c0-ded1-eb61f76984e2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["['íĹĮ', 'ìĭłê³¼', 'Ġì±ħìŀĦê°Ĳ', 'ìĿĦ', 'Ġì§ĢëĭĮ', 'ĠìĿ¸ìŀ¬', 'Ġêµ°ëĮĢ', 'ë¥¼', 'ĠìłĦìĹŃ', 'íķľ', 'ĠíĽĦ', 'ĠíķĺëĿ½', 'íķľ', 'ĠëģĪ', 'ê¸°ìĻĢ', 'ĠìĿĺì§Ģ', 'ë¥¼', 'ĠëģĮìĸ´ìĺ¬ë¦¬']\n"]}]},{"cell_type":"code","source":["print(tokenizer.encode(\"헌신과 책임감을 지닌 인재 군대를 전역한 후 하락한 끈기와 의지를 끌어올리\"))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bux8EOUpSm7n","executionInfo":{"status":"ok","timestamp":1664420336928,"user_tz":-540,"elapsed":18,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"75490684-b3f1-413c-ffef-73209d8d4d17"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[2045, 38354, 17152, 387, 4821, 6508, 4702, 413, 8099, 393, 809, 5692, 393, 6200, 16132, 3625, 413, 22671]\n"]}]},{"cell_type":"code","source":["for elem in tokenizer.encode(\"헌신과 책임감을 지닌 인재 군대를 전역한 후 하락한 끈기와 의지를 끌어올리\"):\n","  print(tokenizer.decode(elem))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-60FnN9tSoNW","executionInfo":{"status":"ok","timestamp":1664420336928,"user_tz":-540,"elapsed":16,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"840ed671-07a3-409f-e3eb-b6be235c38c8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["헌\n","신과\n"," 책임감\n","을\n"," 지닌\n"," 인재\n"," 군대\n","를\n"," 전역\n","한\n"," 후\n"," 하락\n","한\n"," 끈\n","기와\n"," 의지\n","를\n"," 끌어올리\n"]}]},{"cell_type":"code","source":["for elem in tokenizer.encode(\"happy birthday~!\"):\n","  print(tokenizer.decode(elem))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"AFRLdXp2SpAv","executionInfo":{"status":"ok","timestamp":1664420336928,"user_tz":-540,"elapsed":14,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"f225a652-4baa-46e5-c401-1d97f2205415"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["h\n","appy\n"," birth\n","day\n","~\n","!\n"]}]},{"cell_type":"code","source":["print(tokenizer.decode(3))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UykdbrTCSqIu","executionInfo":{"status":"ok","timestamp":1664420336929,"user_tz":-540,"elapsed":13,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"9fb5d7d6-1b01-4104-cb39-baa483e55cb1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[PAD]\n"]}]},{"cell_type":"code","source":["max_seq_len = 500"],"metadata":{"id":"2_fasE9KSrCn"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["encoded_result = tokenizer.encode(\"전율을 일으키는 영화. 다시 보고싶은 영화\", max_length=max_seq_len, pad_to_max_length=True)\n","print(encoded_result)\n","print('길이 :', len(encoded_result))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"9MammB3DSru_","executionInfo":{"status":"ok","timestamp":1664420336929,"user_tz":-540,"elapsed":10,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"d1215c48-a6e0-4aad-b11e-df99112e9a1e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation=True` to explicitly truncate examples to max length. Defaulting to 'longest_first' truncation strategy. If you encode pairs of sequences (GLUE-style) with the tokenizer you can select this strategy more precisely by providing a specific strategy to `truncation`.\n"]},{"output_type":"stream","name":"stdout","text":["[554, 1234, 387, 5142, 378, 1528, 120, 1396, 1581, 5529, 409, 1528, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3]\n","길이 : 600\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_base.py:2308: FutureWarning: The `pad_to_max_length` argument is deprecated and will be removed in a future version, use `padding=True` or `padding='longest'` to pad to the longest sequence in the batch, or use `padding='max_length'` to pad to a max length. In this case, you can give a specific length with `max_length` (e.g. `max_length=45`) or leave max_length to None to pad to the maximal input size of the model (e.g. 512 for Bert).\n","  FutureWarning,\n"]}]},{"cell_type":"code","source":["def convert_examples_to_features(examples, labels, max_seq_len, tokenizer):\n","\n","    input_ids, data_labels = [], []\n","    \n","    for example, label in tqdm(zip(examples, labels), total=len(examples)):\n","\n","        bos_token = [tokenizer.bos_token]\n","        eos_token = [tokenizer.eos_token]\n","        tokens = bos_token + tokenizer.tokenize(example) + eos_token\n","        input_id = tokenizer.convert_tokens_to_ids(tokens)\n","        input_id = pad_sequences([input_id], maxlen=max_seq_len, value=tokenizer.pad_token_id, padding='post')[0]\n","\n","        assert len(input_id) == max_seq_len, \"Error with input length {} vs {}\".format(len(input_id), max_seq_len)\n","        input_ids.append(input_id)\n","        data_labels.append(label)\n","\n","    input_ids = np.array(input_ids, dtype=int)\n","    data_labels = np.asarray(data_labels, dtype=np.int32)\n","\n","    return input_ids, data_labels"],"metadata":{"id":"YwHJ2IcbSs0t"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["train_X, train_y = convert_examples_to_features(train_data['document'], train_data['label'], max_seq_len=max_seq_len, tokenizer=tokenizer)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"oagLaBzkSv9I","executionInfo":{"status":"ok","timestamp":1664420370483,"user_tz":-540,"elapsed":33561,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"dd6d4fca-ae1f-4848-f7ed-bb1dcef0f3f6"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 5363/5363 [00:33<00:00, 157.76it/s]\n"]}]},{"cell_type":"code","source":["test_X, test_y = convert_examples_to_features(test_data['document'], test_data['label'], max_seq_len=max_seq_len, tokenizer=tokenizer)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rhLq0rjuSxGf","executionInfo":{"status":"ok","timestamp":1664420372760,"user_tz":-540,"elapsed":2281,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"7549a8ff-e7a7-4b17-fc4e-c036f918cb64"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["100%|██████████| 518/518 [00:02<00:00, 235.41it/s]\n"]}]},{"cell_type":"code","source":["# 최대 길이: 128\n","input_id = train_X[0]\n","label = train_y[0]\n","\n","print('단어에 대한 정수 인코딩 :',input_id)\n","print('각 인코딩의 길이 :', len(input_id))\n","print('정수 인코딩 복원 :',tokenizer.decode(input_id))\n","print('레이블 :',label)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hZwG8v0qS1qQ","executionInfo":{"status":"ok","timestamp":1664420372761,"user_tz":-540,"elapsed":17,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"88e492f7-9a8c-4a87-aea1-3a044180405b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["단어에 대한 정수 인코딩 : [    0 15734  2155   393  1809   409  3837 60003  2810   448  3059   726\n","  2416   379  7195  1938 12519  4445 27523  6708   413 49637   387   637\n","   644   743   120 63997 63997   165  1554  9979   376  4445   167 63997\n"," 63997 40272 12519   438   515  1569   409  5702  2416  1842  1473  9979\n","   376  1290  2201   523   487  1170   118  2086   470   450  2409   387\n","  4127   862  2030 56313   903   743   120  9971  3920 17885   379  2752\n","  1172  1060  1040  2086   470   450   812   409  2012   413  5236   511\n","  8887 60003  1157   385   644   395   118  3463   529   708   831  3035\n","  2416   413  4728   395 27651  4445 60003  1157   551   743   120 63997\n"," 63997   777  1584  4140   392 15068  3896  4254 10360   443 26943   427\n","  1179   118   884   418   379  1125   393 46574   118   973  5291  7441\n","  3680  4434   387  2901 60003   922   779  3594  9480  2401  5398 10160\n","   379  4445   551   743   120  2034   387  1627 27274  1865   812   409\n","  5823   413  3341   385   644   395  2810   529   708   118  9855  1584\n","  4445   376   529  1865  1937   478  4061   385   404   610   797   743\n","   120 63997 63997 23943   637  2901   413   590   200   126  1547   997\n"," 21893   805   640   726   831   644   708   118  1548   387  1182   385\n","   478  1204   395   921  1051   591  3743   936  1547   997  1998  5410\n","  2901   385   862  1938   551   743   120  1411  1938   387  1483   447\n","   853   510  1191   379  1584  1356  2551 10520   387  4913   584   467\n","   426   529   743   120  3359   383  5702  1699   418   640   529   726\n","   549   402  1627   447  8406  2416   379  4445  2586   118  1937   478\n","  4061   385   404   610   395  7195  1938 27523  6708   551   419   960\n","   379  2155   393  1809   376   529   837  1032  3986   120 63997 63997\n","   376   413  1157   447   831  1464   387   813  1989  1567   395  1388\n","   409  9999   376  5274   395   461  1126   813  1105   409  1333   387\n","  4263   419  1157   551   743   120  1286   118  2810   395  2979  1440\n","   379  9532   551   387   818  1937   478  4061   385   378  3995   376\n","   426   529   708   118   410 31217   387  1809   393  1314   392   378\n","  2810   395  2979  1440   379   585  2755 52463   898   467   426   844\n","  1464  8096  4124   413  1783   478   693   529   743   120 58708  1157\n","   447 24316  1341   479   515  1569   549   402  8406   752  1040  2416\n","   379  7195  4445   385   644   395   118   410  1286  3010   413  2981\n"," 49637   743   120 63997     1     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3\n","     3     3     3     3     3     3     3     3     3     3     3     3]\n","각 인코딩의 길이 : 600\n","정수 인코딩 복원 : [BOS]저의 특별한 경험은 달성하기 힘들어 보였던 목표에 끊임없이 노력하고 도전하여 성취를 이뤄냈을 때였습니다.\n","\n","[베짱이 도전]\n","\n","전역하고 1년 동안은 아무런 목표 없이 베짱이처럼 게임만 하거나, 친구들과 술을 마시면서 놀기만 했습니다. 그해 겨울방학에 부모님께 다른 친구들과 많은 비교를 당하여 반성하기 시작하였고, 늦었지만 저만의 목표를 정하고 이에 도전하기 시작했습니다.\n","\n","그 첫 출발로 엔지니어로서의 필수역량인 도면해독, 작도에 필요한 CAD, CATIA 설계프로그램을 공부하기 위해 ‘기계설계산업기사’에 도전했습니다. 프로그램을 처음 접했기에 많은 실수를 반복하였고 힘들었지만, 저의 첫 도전이었기에 쉽게 포기하지 않았습니다.\n","\n","대학생 때 공부를 3~4시간 이상 해본 적 없던 저였지만, 마음을 독하게 먹고 두 달간 매일 8시간 이상씩 꾸준히 공부하면서 노력했습니다. 이런 노력을 끝으로 단 한 번에 첫 국가기술 자격증을 취득할 수 있었습니다. 인생의 아무런 계획도 없었던 제가 처음으로 정한 목표에 도전했으며, 쉽게 포기하지 않고 끊임없이 노력하여 성취했기 때문에 특별한 경험이었다고 생각됩니다.\n","\n","이를 시작으로 저 자신을 더 발전시키고 싶은 욕심이 생겼고 그보다 더 높은 곳을 바라보기 시작했습니다. 또한, 힘들고 어려운 상황에 직면했을 경우 쉽게 포기하는 경향이 있었지만, 이 성취감을 경험한 뒤로는 힘들고 어려운 상황에 부닥쳐도 할 수 있다는 자신감과 용기를 얻게 되었습니다. 이를 시작으로 하여 지난 2년 동안 제가 정한 또 다른 목표에 끊임없이 도전하였고, 이 또한 성과를 반드시 이뤄냈습니다.\n","[EOS][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD][PAD]\n","레이블 : 1\n"]}]},{"cell_type":"code","source":["model = TFGPT2Model.from_pretrained('skt/kogpt2-base-v2', from_pt=True)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":193,"referenced_widgets":["0d5033c0f75145ecadf9643fca3fabc2","03e7b37973374fe58eeea2ed8b3ebd1a","dcfa2437a083474babd641b9501d9696","98f413b19ed4490b9a8a4bc01081e25e","d572ead914bc4f6ebdad7bf2e132e6b8","cc79b8720ee24225a4fb28865c6aa4f2","4a46f952c2c14d9fba9104c7958c0e2c","0ed2b703a3fe4016aeee91197858cfef","8e6bc5dccb6943df9cc5419605b19ebd","16578ed5bb0b49c589299e4eac32331a","fe6e438a8c254d2e86eb53096c4b1856","3ce8f62eca194a03bdb0eecbb3092ed6","ebf2d7a3515243eba9588469282eb927","b46d58e32a8146378dbdc7de5c539e3b","b8a40fa51769497c8c7bf5562a967c06","9d418faef1a64ba1b445dcb9e43023d5","689bd0d4140444729bf5364912d89966","099f76983af64133a8a8d99940e0907f","2f5fd737b69347feb13c107a4b549a67","f08f685d7cc2430389e23ce32f46219c","525845a1894a45bd8eb24f964c83f1bb","566d4be5380c482388f208eead478373"]},"id":"3Zlh6TAnS3Q_","executionInfo":{"status":"ok","timestamp":1664420419763,"user_tz":-540,"elapsed":46266,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"2908e640-6ff9-4b1e-9183-a3a5997a9847"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/1.00k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0d5033c0f75145ecadf9643fca3fabc2"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/513M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3ce8f62eca194a03bdb0eecbb3092ed6"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the PyTorch model were not used when initializing the TF 2.0 model TFGPT2Model: ['transformer.h.8.attn.masked_bias', 'transformer.h.2.attn.masked_bias', 'transformer.h.3.attn.masked_bias', 'transformer.h.0.attn.masked_bias', 'transformer.h.11.attn.masked_bias', 'transformer.h.7.attn.masked_bias', 'transformer.h.1.attn.masked_bias', 'transformer.h.5.attn.masked_bias', 'lm_head.weight', 'transformer.h.4.attn.masked_bias', 'transformer.h.6.attn.masked_bias', 'transformer.h.9.attn.masked_bias', 'transformer.h.10.attn.masked_bias']\n","- This IS expected if you are initializing TFGPT2Model from a PyTorch model trained on another task or with another architecture (e.g. initializing a TFBertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing TFGPT2Model from a PyTorch model that you expect to be exactly identical (e.g. initializing a TFBertForSequenceClassification model from a BertForSequenceClassification model).\n","All the weights of TFGPT2Model were initialized from the PyTorch model.\n","If your task is similar to the task the model of the checkpoint was trained on, you can already use TFGPT2Model for predictions without further training.\n"]}]},{"cell_type":"code","source":["max_seq_len = 500"],"metadata":{"id":"ztKjVoMKS4SP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["input_ids_layer = tf.keras.layers.Input(shape=(max_seq_len,), dtype=tf.int32)\n","outputs = model([input_ids_layer])"],"metadata":{"id":"rUCGclamS5lP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(outputs)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"y4ZS0S1cS6ev","executionInfo":{"status":"ok","timestamp":1664420426382,"user_tz":-540,"elapsed":662,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"75f64f2c-5c1d-41ca-9301-0c28636905f5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["TFBaseModelOutputWithPastAndCrossAttentions(last_hidden_state=<KerasTensor: shape=(None, 500, 768) dtype=float32 (created by layer 'tfgpt2_model')>, past_key_values=(<KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>), hidden_states=None, attentions=None, cross_attentions=None)\n"]}]},{"cell_type":"code","source":["print(outputs[0])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VdEY7g3gS7X_","executionInfo":{"status":"ok","timestamp":1664420426383,"user_tz":-540,"elapsed":13,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"78fa1e47-d006-4bd9-8df2-22dfe68bd5ab"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["KerasTensor(type_spec=TensorSpec(shape=(None, 500, 768), dtype=tf.float32, name=None), name='tfgpt2_model/transformer/Reshape_2:0', description=\"created by layer 'tfgpt2_model'\")\n"]}]},{"cell_type":"code","source":["print(outputs[1])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5mDh2b94S-Tv","executionInfo":{"status":"ok","timestamp":1664420426383,"user_tz":-540,"elapsed":10,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"064b2fb7-09ec-49d6-fbb1-d0b7de654da2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["(<KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>, <KerasTensor: shape=(2, None, 12, 500, 64) dtype=float32 (created by layer 'tfgpt2_model')>)\n"]}]},{"cell_type":"code","source":["print(outputs[0][:, -1])\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fAFiEh1sS_yf","executionInfo":{"status":"ok","timestamp":1664420426383,"user_tz":-540,"elapsed":7,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"b70316be-d8a0-43af-9be3-7b0043bb0b48"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["KerasTensor(type_spec=TensorSpec(shape=(None, 768), dtype=tf.float32, name=None), name='tf.__operators__.getitem/strided_slice:0', description=\"created by layer 'tf.__operators__.getitem'\")\n"]}]},{"cell_type":"code","source":["class TFGPT2ForSequenceClassification(tf.keras.Model):\n","    def __init__(self, model_name):\n","        super(TFGPT2ForSequenceClassification, self).__init__()\n","        self.gpt = TFGPT2Model.from_pretrained(model_name, from_pt=True)\n","        self.dropout = tf.keras.layers.Dropout(0.2)\n","        self.classifier = tf.keras.layers.Dense(1,\n","                                                kernel_initializer=tf.keras.initializers.TruncatedNormal(0.02),\n","                                                activation='sigmoid',\n","                                                name='classifier')\n","\n","    def call(self, inputs):\n","        outputs = self.gpt(input_ids=inputs)\n","        cls_token = outputs[0][:, -1]\n","        cls_token = self.dropout(cls_token)\n","        prediction = self.classifier(cls_token)\n","\n","        return prediction"],"metadata":{"id":"J3LP600rTAzP"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# TPU 작동을 위한 코드\n","resolver = tf.distribute.cluster_resolver.TPUClusterResolver(tpu='grpc://' + os.environ['COLAB_TPU_ADDR'])\n","tf.config.experimental_connect_to_cluster(resolver)\n","tf.tpu.experimental.initialize_tpu_system(resolver)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Q29aay6yTCTX","executionInfo":{"status":"ok","timestamp":1664420438118,"user_tz":-540,"elapsed":11740,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"dd1abbbf-03d5-47d6-9c64-33d9ee6ea87c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:tensorflow:TPU system grpc://10.126.182.106:8470 has already been initialized. Reinitializing the TPU can cause previously created variables on TPU to be lost.\n"]},{"output_type":"execute_result","data":{"text/plain":["<tensorflow.python.tpu.topology.Topology at 0x7f4c7f6f1b90>"]},"metadata":{},"execution_count":45}]},{"cell_type":"code","source":["strategy = tf.distribute.experimental.TPUStrategy(resolver)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fVdS-Ce0TFHu","executionInfo":{"status":"ok","timestamp":1664420438119,"user_tz":-540,"elapsed":6,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"c2fb8c30-df51-47cc-97f1-25df77a34198"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:absl:`tf.distribute.experimental.TPUStrategy` is deprecated, please use  the non experimental symbol `tf.distribute.TPUStrategy` instead.\n"]}]},{"cell_type":"code","source":["with strategy.scope():\n","  model = TFGPT2ForSequenceClassification(\"skt/kogpt2-base-v2\")\n","  optimizer = tf.keras.optimizers.Adam(learning_rate=5e-5)\n","  loss = tf.keras.losses.BinaryCrossentropy()\n","  model.compile(optimizer=optimizer, loss=loss, metrics = ['accuracy'])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"l0CrbJp3V4WV","executionInfo":{"status":"ok","timestamp":1664420479800,"user_tz":-540,"elapsed":41685,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"2d12d7ad-13b8-4fe6-9255-064936cf65cd"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Some weights of the PyTorch model were not used when initializing the TF 2.0 model TFGPT2Model: ['transformer.h.8.attn.masked_bias', 'transformer.h.2.attn.masked_bias', 'transformer.h.3.attn.masked_bias', 'transformer.h.0.attn.masked_bias', 'transformer.h.11.attn.masked_bias', 'transformer.h.7.attn.masked_bias', 'transformer.h.1.attn.masked_bias', 'transformer.h.5.attn.masked_bias', 'lm_head.weight', 'transformer.h.4.attn.masked_bias', 'transformer.h.6.attn.masked_bias', 'transformer.h.9.attn.masked_bias', 'transformer.h.10.attn.masked_bias']\n","- This IS expected if you are initializing TFGPT2Model from a PyTorch model trained on another task or with another architecture (e.g. initializing a TFBertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing TFGPT2Model from a PyTorch model that you expect to be exactly identical (e.g. initializing a TFBertForSequenceClassification model from a BertForSequenceClassification model).\n","All the weights of TFGPT2Model were initialized from the PyTorch model.\n","If your task is similar to the task the model of the checkpoint was trained on, you can already use TFGPT2Model for predictions without further training.\n"]}]},{"cell_type":"code","source":["%%time\n","history=model.fit(train_X, train_y, epochs=7, batch_size=8, validation_split=0.35)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZnDP6ta4V4vt","executionInfo":{"status":"ok","timestamp":1664421002024,"user_tz":-540,"elapsed":522228,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"71845b36-e7ba-40bf-ed8e-602b58012fad"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/7\n","436/436 [==============================] - 147s 161ms/step - loss: 0.7651 - accuracy: 0.5813 - val_loss: 0.6223 - val_accuracy: 0.6534\n","Epoch 2/7\n","436/436 [==============================] - 62s 142ms/step - loss: 0.4326 - accuracy: 0.8077 - val_loss: 0.4831 - val_accuracy: 0.7982\n","Epoch 3/7\n","436/436 [==============================] - 62s 143ms/step - loss: 0.2723 - accuracy: 0.8935 - val_loss: 0.6523 - val_accuracy: 0.7694\n","Epoch 4/7\n","436/436 [==============================] - 62s 143ms/step - loss: 0.1310 - accuracy: 0.9486 - val_loss: 0.5581 - val_accuracy: 0.7966\n","Epoch 5/7\n","436/436 [==============================] - 63s 144ms/step - loss: 0.0579 - accuracy: 0.9816 - val_loss: 0.8014 - val_accuracy: 0.7939\n","Epoch 6/7\n","436/436 [==============================] - 62s 143ms/step - loss: 0.0290 - accuracy: 0.9914 - val_loss: 0.9490 - val_accuracy: 0.7993\n","Epoch 7/7\n","436/436 [==============================] - 62s 143ms/step - loss: 0.0229 - accuracy: 0.9928 - val_loss: 1.0698 - val_accuracy: 0.7918\n","CPU times: user 1min 39s, sys: 9.41 s, total: 1min 49s\n","Wall time: 8min 42s\n"]}]},{"cell_type":"code","source":["results = model.evaluate(test_X, test_y, batch_size=8)\n","print(\"test loss, test acc: \", results)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"lxDOp8aIV5qd","executionInfo":{"status":"ok","timestamp":1664421005265,"user_tz":-540,"elapsed":3246,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"1f214bd0-ad9f-4b0c-c543-da44f3546432"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["65/65 [==============================] - 3s 42ms/step - loss: 1.0345 - accuracy: 0.7819\n","test loss, test acc:  [1.0344748497009277, 0.7818533182144165]\n"]}]},{"cell_type":"code","source":["model.save('ep7_bat32.bin')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GoNr7KhlW0fS","executionInfo":{"status":"ok","timestamp":1663232851364,"user_tz":-540,"elapsed":67571,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"8ab6c6a5-091c-48d1-cb33-64e045b4b3e7"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:absl:Found untraced functions such as wte_layer_call_fn, wte_layer_call_and_return_conditional_losses, dropout_226_layer_call_fn, dropout_226_layer_call_and_return_conditional_losses, ln_f_layer_call_fn while saving (showing 5 of 294). These functions will not be directly callable after loading.\n"]}]},{"cell_type":"code","source":["import matplotlib.pyplot as plt\n","epochs = range(1, len(history.history['accuracy']) + 1)\n","plt.plot(epochs, history.history['loss'])\n","plt.plot(epochs, history.history['val_loss'])\n","plt.title('model loss')\n","plt.ylabel('loss')\n","plt.xlabel('epoch')\n","plt.legend(['train', 'test'], loc='upper left')\n","plt.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":295},"id":"yLfPRWlnCvco","executionInfo":{"status":"ok","timestamp":1664422240402,"user_tz":-540,"elapsed":907,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"cbb07b7b-e54d-44ae-9e9d-b62492822fe5"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"markdown","source":["전체적으로는 검증 데이터의 손실이 줄어드는 경향이 있지만 뒤로 갈수록 점차 검증 데이터의 손실이 증가하려고 하는 경향이 보입니다. 이는 과적합의 신호일 수 있습니다."],"metadata":{"id":"HFrH1ROXDVbt"}},{"cell_type":"code","source":["y_pred = model.predict(test_X, batch_size=32)"],"metadata":{"id":"AlEv8JS0oeRK"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# from sklearn import metrics\n","\n","# print('precision', metrics.precision_score(test_X,y_pred))\n","# print('recall', metrics.recall_score(test_X,y_pred))\n","# print('f1_score', metrics.f1_score(test_X,y_pred))"],"metadata":{"id":"OkAMZ7yL1yyD"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def sentiment_predict(new_sentence):\n","\n","  bos_token = [tokenizer.bos_token]\n","  eos_token = [tokenizer.eos_token]\n","  tokens = bos_token + tokenizer.tokenize(new_sentence) + eos_token\n","  input_id = tokenizer.convert_tokens_to_ids(tokens)\n","  input_id = pad_sequences([input_id], maxlen=max_seq_len, value=tokenizer.pad_token_id, padding='post')[0]\n","  input_id = np.array([input_id])\n","  score = model.predict(input_id)[0][0]\n","\n","  if(score > 0.5):\n","    print(\"{:.2f}% 확률로 경험 자소서입니다.\\n\".format(score * 100))\n","  else:\n","    print(\"{:.2f}% 확률로 지원 자소서입니다.\\n\".format((1 - score) * 100))\n","\n"],"metadata":{"id":"mclWf_uBV6ql"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["1이 경험 / 0 이 지원동기"],"metadata":{"id":"VQLZrIMgw4zI"}},{"cell_type":"code","source":["#0 지원\n","sentiment_predict(\"아버지께서는 개인/법인 관련 보험 영업을 하면서 16년 간 수많은 회사와 고객에게 보험 상품을 선사했습니다. 직접 발로 뛰고 노력하며 고객을 만남으로써 성과를 도출하고, 고객에게 만족을 드리는 점을 지켜보았습니다. 보험업은 본인이 열심히 일을 한 만큼 성과가 뒤따르고 결실을 맺을 수 있기에, 지금까지도 꾸준하게 해당 업종에서 근무를 하고 계십니다. 그리고 업무의 만족도가 높아 타인에게 추천을 할 정도입니다.\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"LpWivJdbV78f","executionInfo":{"status":"ok","timestamp":1664422262263,"user_tz":-540,"elapsed":10293,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"fcf3ebff-dc25-44a9-b0d4-6b99364160ef"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["99.81% 확률로 지원 자소서입니다.\n","\n"]}]},{"cell_type":"code","source":["# 1 경험\n","sentiment_predict(\"수련생이 가져야 할 가장 중요한 덕목은 ‘일관성’과 ‘투명함’이라고 생각합니다. 누구나 활용할 수 있도록 데이터목록을 구성하고 품질을 진단하는 수련생은 일관성 있는 규칙을 따라야 하며, 투명성을 지켜야하기 때문입니다.매뉴얼을 체계화하여 회비관리를 안정화하고 투명한 이미지를 제고했던 적이 있습니다. 총무부장으로 활동 당시 일관된 서식 없이 회비장부가 책임자 각자의 방식으로 작성되어, 과 구성원들의 신뢰도는 낮아져만 갔습니다.\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_D3WpdiPbRn7","executionInfo":{"status":"ok","timestamp":1664422263195,"user_tz":-540,"elapsed":938,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"3782c8fc-f72a-4033-c278-b06ee9818432"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["99.99% 확률로 경험 자소서입니다.\n","\n"]}]},{"cell_type":"code","source":["# 1 경험\n","sentiment_predict(\"지금 우리 팀에 필요한 것은 무엇일까?] 숭실대 경력개발센터 서포터즈로 활동하며 1주일에 1회 소통 day를 만들어 센터 이용률 10% 향상에 기여한 경험이 있습니다. 당시 저희는 행사 진행 전 ‘기획, 촬영, 진행 총괄, 서기’로 역할을 나누었습니다. 하지만 문제는 역할분배에서 나타났습니다. ‘누군가 하겠지’라는 생각 때문에 행사 당일 필요한 포스터를 놓쳤기 때문입니다. 이에 저는 팀원에게 행사 회의와 별도로 진행 중 어려운 점을 공유하는 시간을 마련할 것을 제안했습니다. 또한, 이벤트 진행 과정에 대한 의견충돌이 있었기에 저는 팀원과 생각이 다른 이유에 대해 논하면서 차이점보다는 공통점이 많다는 점을 알게 되었습니다. 행사는 본교 학생들이 미션 수행 뒤 저희가 갖고 싶은 물건을 먼저 물어보고 다시 룰렛을 돌려 갖고 싶은 상품이 나올 때까지 도와주기로 의견을 모았습니다\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"aJEIOYk0bXDr","executionInfo":{"status":"ok","timestamp":1664422264509,"user_tz":-540,"elapsed":1316,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"4df3392b-5595-4620-e514-add65ebba091"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["100.00% 확률로 경험 자소서입니다.\n","\n"]}]},{"cell_type":"code","source":["#0 지원\n","sentiment_predict(\"저는 '꾸준히 성장하는' 엔지니어가 되고 싶어서 ASML에 지원했습니다. 13년간 EUV를 위해 포기하지 않고 도전해오며 Hi-tech의 극을 보여준 ASML의 성장은 3C 로 대변되는 Challenge, Collaborate, Care의 조직문화 덕분이라고 생각합니다.\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"z003DaJ1bbj0","executionInfo":{"status":"ok","timestamp":1664422264921,"user_tz":-540,"elapsed":413,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"5a7776bd-6c0a-4ddc-8594-81ecfe54d0a0"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["99.96% 확률로 지원 자소서입니다.\n","\n"]}]},{"cell_type":"code","source":["#1 경험\n","sentiment_predict(\"석사 과정 Inverse Opal 구조의 광전극을 제작하는 연구를 진행했습니다. 미리 제작한 Nano pattern Mask를 활용한 Contact align 방식의 Photolithography 실험을 진행했습니다. 그러나 공정 중간에 형성된 패턴 층이 붕괴되는 문제가 지속해서 발생했습니다. 주어진 기간 내에 문제를 해결하기 위해 PR 제조사, 타 연구실의 조언을 구했습니다. 이를 통해 사이즈에 맞지 않는 PR 층 두께와 불완전한 공정 recipe가 원인임을 파악했습니다. 우선 PR (SU-8) 제품의 Data Sheet를 참고해 코팅 조건을 변경하여 Nano pattern 사이즈에 맞는 두께의 PR 층을 형성했습니다.\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZQZb6aOfbc1r","executionInfo":{"status":"ok","timestamp":1664422266416,"user_tz":-540,"elapsed":1501,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"fd614815-8bc7-472e-f948-3026ee58673d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["99.98% 확률로 경험 자소서입니다.\n","\n"]}]},{"cell_type":"code","source":["# 1 경험\n","sentiment_predict('멀티플렉스 매니저는 고객 중심 사고를 바탕으로 업무에 임해야한다 생각합니다. 서비스를 통해 만족을 제공하기 위해선 기획부터 실행에 이르기까지 충실한 고객 중심 사고가 그 기반이 되어야 하기 때문입니다.저는 서비스직 아르바이트를 경험하며 서비스마인드를 체화했습니다. 매장 내 고객의 편의를 위해 동선 변경, 상품 구성 등을 변경하며 방문율을 제고하였고, 방문이 구매로까지 이어지는 프로세스를 만들고자 노력했습니다.')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tShQPXZabgOT","executionInfo":{"status":"ok","timestamp":1664422267562,"user_tz":-540,"elapsed":1148,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"4bda8b43-04fb-4652-f2e2-5be2f9b095fb"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["94.73% 확률로 경험 자소서입니다.\n","\n"]}]},{"cell_type":"code","source":["# 0 지원\n","sentiment_predict(\"청소년 수련업에 종사하시는 아버지로부터 현장을 경험했습니다. 수련회가원활히 진행될 수 있도록 현장 상황을 지휘하는 아버지의 모습에 ‘현장의 주인’과도 같은 관리직에 매력을 느꼈습니다. 이에 CGV에 방문할 때마다 Multiplex Manager의 움직임에관심을 가졌습니다. 매표소, 검표대, 매점 등의 전 구역에서 고객만족을 책임지는 모습을 보며, 현장관리자로서의역량을 발휘할 수 있는 직무라는 점을 확신했습니다.Multiplex Manager는1) 빠른 적응력과 2) 소통능력을 갖춰야 한다고 생각합니다. 저는 다음과 같은 경험들을 통해 ‘매장의 주인’이 될 준비를 마쳤습니다.\")"],"metadata":{"id":"6JnlWI8EgFUo","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1664422268852,"user_tz":-540,"elapsed":1294,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"e0a0e684-f295-4066-8a5f-dc05cc19552c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["99.72% 확률로 지원 자소서입니다.\n","\n"]}]},{"cell_type":"code","source":["# 0 지원\n","sentiment_predict(\"구성원의가능성을 실현시켜 조직의 목표 달성으로 연결하는 과정 속에서 HR의 매력을 깨달았습니다. 대학 입학 이후 지금까지 동기들을 이끌어 7번의 여행을 다녀왔습니다. 구성원 한 명 한 명을 관찰하고 각자에게 어울리는 역할을 배분하여 모두가 만족하는 풍성한 여행을 만들었습니다. 개인의 역량을 이끌어내 공동의 목표를 달성하는 이 과정 속에서 큰 보람을 느꼈습니다. 앞으로 CJ오쇼핑에서도 조직원들과 소통하며 그들이 가진 역량을 파악하고, 이를 조직의 비전 달성으로 연결하는 HR전문가가 되고자 합니다.\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qwKKC2Sh3GS5","executionInfo":{"status":"ok","timestamp":1664422270125,"user_tz":-540,"elapsed":1277,"user":{"displayName":"준영이","userId":"13830995591858307246"}},"outputId":"d1313090-eae1-4ee4-e8be-0c0329ceb38e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["99.90% 확률로 지원 자소서입니다.\n","\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"037L18oZy1lB"},"execution_count":null,"outputs":[]}]}